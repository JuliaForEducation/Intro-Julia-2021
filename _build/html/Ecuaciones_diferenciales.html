
<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ecuaciones diferenciales &#8212; Project-oriented workshop in Julia computing</title>
    
  <link rel="stylesheet" href="_static/css/index.d431a4ee1c1efae0e38bdfebc22debff.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.bfb7730f9caf2ec0b46a44615585038c.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.30270b6e4c972e43c488.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/translations.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/logo.ico"/>
    <link rel="index" title="Índice" href="genindex.html" />
    <link rel="search" title="Búsqueda" href="search.html" />
    <link rel="next" title="Paquete DataFrames" href="Paquete_DataFrames.html" />
    <link rel="prev" title="Paquete Plots" href="Paquete_Plots.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/julia_logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Project-oriented workshop in Julia computing</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Buscar este libro ..." aria-label="Buscar este libro ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Intro.html">
   Project-oriented workshop in Julia computing
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Primera Semana
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Git_y_GitHub.html">
   Git y GitHub
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Fundamentos.html">
   Fundamentos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Estructuras_de_Control.html">
   Estructuras de Control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Estructuras_de_Datos.html">
   Estructuras de Datos
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Segunda Semana
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Paquete_Plots.html">
   Paquete Plots
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Ecuaciones diferenciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Paquete_DataFrames.html">
   Paquete DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Natural_Language_Processing.html">
   Natural Language Processing
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Tercera Semana
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Computaci%C3%B3n_Cu%C3%A1ntica.html">
   Computación Cuántica
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Proyectos
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Primer_proyecto.html">
   Primer proyecto
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lista_proyectos.html">
   Opciones proyectos segunda semana
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Navegación de palanca" aria-controls="site-navigation"
            title="Navegación de palanca" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Descarga esta pagina"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Ecuaciones_diferenciales.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Descargar archivo fuente" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Imprimir en PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/JuliaForEducation/Intro-Julia-2021"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Repositorio de origen"><i
                    class="fab fa-github"></i>repositorio</button></a>
        <a class="issues-button"
            href="https://github.com/JuliaForEducation/Intro-Julia-2021/issues/new?title=Issue%20on%20page%20%2FEcuaciones_diferenciales.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Abrir un problema"><i class="fas fa-lightbulb"></i>Tema abierto</button></a>
        <a class="edit-button" href="https://github.com/JuliaForEducation/Intro-Julia-2021/edit/master/Ecuaciones_diferenciales.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edita esta página"><i class="fas fa-pencil-alt"></i>Tema abierto</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Modo de pantalla completa"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/JuliaForEducation/Intro-Julia-2021/master?urlpath=tree/Ecuaciones_diferenciales.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Lanzamiento Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/JuliaForEducation/Intro-Julia-2021/blob/master/Ecuaciones_diferenciales.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Lanzamiento Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contenido
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preparacion">
   Preparación
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelos-de-ecuaciones-diferenciales-ordinarias-odes">
   Modelos de ecuaciones diferenciales ordinarias (ODEs)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preliminares">
     Preliminares
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-introductorio-la-estructura-general">
     Ejemplo introductorio: La estructura general
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#definicion-de-la-funcion">
       1. Definición de la función
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#definicion-de-las-condiciones-iniciales-y-de-frontera">
       2. Definición de las condiciones iniciales y de frontera
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#planteamiento-del-problema">
       3. Planteamiento del problema
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#resolucion-y-exploracion">
       4. Resolución y exploración
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pendulo-caotico">
     Péndulo caótico
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sistema-de-henon-heiles">
     3. Sistema de Hénon-Heiles
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ecuaciones-diferenciales-estocasticas">
   Ecuaciones diferenciales Estocásticas
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bibliografia">
   Bibliografía
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="ecuaciones-diferenciales">
<h1>Ecuaciones diferenciales<a class="headerlink" href="#ecuaciones-diferenciales" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="preparacion">
<h2>Preparación<a class="headerlink" href="#preparacion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Proseguimos a activar el ambiente de trabajo y cargar los paquetes a utilizar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="n">Pkg</span><span class="p">;</span> <span class="n">Pkg</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">);</span> <span class="n">Pkg</span><span class="o">.</span><span class="n">instantiate</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Green"> Activating</span> environment at `~/julia_for_education/book/Project.toml`
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">DifferentialEquations</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>┌ Info: Precompiling DifferentialEquations [0c46a032-eb83-5123-abaf-570d42b7fbaa]
└ @ Base loading.jl:1278
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="n">Plots</span>
</pre></div>
</div>
</div>
</div>
<p>La siguiente configuración por defecto se coloca para la versión específica de Julia, Plots y backend GR utilizada en construir este documento. Puede ser óptimo cambiarlo a otra para uso personal:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">begin</span>
	<span class="n">size</span> <span class="o">=</span> <span class="mi">50</span>
	<span class="n">Plots</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2600</span><span class="p">,</span><span class="mi">2000</span><span class="p">),</span><span class="n">titlefontsize</span> <span class="o">=</span> <span class="n">size</span><span class="p">,</span> <span class="n">tickfontsize</span> <span class="o">=</span> <span class="n">size</span><span class="p">,</span> <span class="n">legendfontsize</span> <span class="o">=</span> <span class="n">size</span><span class="p">,</span> <span class="n">guidefontsize</span> <span class="o">=</span> <span class="n">size</span><span class="p">,</span> <span class="n">legendtitlefontsize</span> <span class="o">=</span> <span class="n">size</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="modelos-de-ecuaciones-diferenciales-ordinarias-odes">
<h2>Modelos de ecuaciones diferenciales ordinarias (ODEs)<a class="headerlink" href="#modelos-de-ecuaciones-diferenciales-ordinarias-odes" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="preliminares">
<h3>Preliminares<a class="headerlink" href="#preliminares" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Gracias a la gran eficiencia de métodos iterativos y de álgebra lineal, la forma preferencial de pensar en ecuaciones diferenciales es en su forma de <em>sistema de ecuaciones de primer órden</em>. Esto siempre es posible de obtener mediante <a class="reference external" href="https://en.wikipedia.org/wiki/Ordinary_differential_equation##Reduction_of_order">reducción de órden</a>.</p>
<p>Una vez realizado, la forma que obtenemos, para ecuaciones autónomas (no dependientes de manera explícita del tiempo), es:</p>
<div class="math notranslate nohighlight">
\[
x'(t) = F(x(t))
\]</div>
<p>donde <span class="math notranslate nohighlight">\(x: \mathbb{R} \rightarrow \mathbb{R}^n\)</span> es una trayectoria en el espacio para la cual deseamos resolver y obedece la dinámica del campo vectorial:</p>
<div class="math notranslate nohighlight">
\[F: \mathbb{R}^n \rightarrow \mathbb{R}^n\]</div>
<p>Esto define un sistema de <span class="math notranslate nohighlight">\(n\)</span> ecuaciones a resolver. A continuación veremos algunos ejemplos.</p>
</div>
<div class="section" id="ejemplo-introductorio-la-estructura-general">
<h3>Ejemplo introductorio: La estructura general<a class="headerlink" href="#ejemplo-introductorio-la-estructura-general" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Se ejemplifica el procedimiento general de resolución de ecuaciones diferenciales utilizando el paquete <code class="docutils literal notranslate"><span class="pre">DifferentialEquations</span></code> utilizando el ejemplo:</p>
<div class="math notranslate nohighlight">
\[\frac{du}{dx} = f(u, p, t) = \alpha u\]</div>
<p>donde <span class="math notranslate nohighlight">\(u\)</span> es el observable dinámico a encontrar, y la forma general <span class="math notranslate nohighlight">\(f(u, p, t)\)</span> describe la evolución temporal de <span class="math notranslate nohighlight">\(u\)</span> y puede depender de dicho observable: <span class="math notranslate nohighlight">\(u\)</span>, el tiempo paramétrico que describe su dinámica: <span class="math notranslate nohighlight">\(t\)</span>, y parámetros potencialmente exteriores que caracterizan el contexto específico del fenómeno (ejemplo: constantes físicas (masa, aceleración debido a gravedad, permitividad, etc.), indicadores socio-económicos (tasas constantes, natalidad, migración, etc.)).</p>
<p>Los pasos se presentan a continuación</p>
<div class="section" id="definicion-de-la-funcion">
<h4>1. Definición de la función<a class="headerlink" href="#definicion-de-la-funcion" title="Enlazar permanentemente con este título">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.01</span><span class="o">*</span><span class="n">u</span>
</pre></div>
</div>
</div>
</div>
<p>Como descrito anteriormente, <span class="math notranslate nohighlight">\(f\)</span> depende de <span class="math notranslate nohighlight">\(u, p, t\)</span>, pero solamente es obligatoria la dependencia de <span class="math notranslate nohighlight">\(u\)</span> (salvo el caso trivial donde <span class="math notranslate nohighlight">\(f\)</span> es constante y en dado caso no necesitamos resolución numérica), mientras que, en este caso, no tenemos parámetros movibles <span class="math notranslate nohighlight">\(p\)</span> ni tampoco el tiempo <span class="math notranslate nohighlight">\(t\)</span> explícito, aunque por supuesto <span class="math notranslate nohighlight">\(u\)</span> se asume ser función del tiempo (<span class="math notranslate nohighlight">\(u = u(t)\)</span>).</p>
</div>
<div class="section" id="definicion-de-las-condiciones-iniciales-y-de-frontera">
<h4>2. Definición de las condiciones iniciales y de frontera<a class="headerlink" href="#definicion-de-las-condiciones-iniciales-y-de-frontera" title="Enlazar permanentemente con este título">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">u₀</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="n">tspan_u</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Aquí <span class="math notranslate nohighlight">\(u_0\)</span> es el valor inicial tomado por la variable dinámica <span class="math notranslate nohighlight">\(u\)</span>. El tiempo inicial se define en el intervalo <code class="docutils literal notranslate"><span class="pre">tspan_u</span></code>, que es una tupla de un valor inicial y un valor final (<span class="math notranslate nohighlight">\(t_0\)</span>, <span class="math notranslate nohighlight">\(t_f\)</span>).</p>
<p>Es este intervalo el cual será particionado en una cadena discreta de puntos <span class="math notranslate nohighlight">\(\{t_0, t_1, t_2, \ldots, t_{n-1}, t_f\}\)</span> y obtener los valores de <span class="math notranslate nohighlight">\(u\)</span> en dichos tiempos: <span class="math notranslate nohighlight">\(\{u(t_0), u(t_1), u(t_2), \ldots, u(t_{n-1}), u(t_f)\}\)</span>.</p>
</div>
<div class="section" id="planteamiento-del-problema">
<h4>3. Planteamiento del problema<a class="headerlink" href="#planteamiento-del-problema" title="Enlazar permanentemente con este título">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">prob_u</span> <span class="o">=</span> <span class="n">ODEProblem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">u₀</span><span class="p">,</span><span class="n">tspan_u</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Este es un ejemplo de un problema planteado como una ecuación diferencial ordinaria de primer orden. En su lugar, pudimos haber definido una de orden superior, una estocástica, integrodiferencial, etc.</p>
<p>Ejemplos de estos serán mostrados luego.</p>
</div>
<div class="section" id="resolucion-y-exploracion">
<h4>4. Resolución y exploración<a class="headerlink" href="#resolucion-y-exploracion" title="Enlazar permanentemente con este título">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">sol_u</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">prob_u</span><span class="p">,</span> <span class="n">Tsit5</span><span class="p">(),</span> <span class="n">reltol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span> <span class="n">abstol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>La función <code class="docutils literal notranslate"><span class="pre">solve</span></code> es una de las funciones más complejas (en cuanto a completitud y flexibilidad) del paquete, siendo la misma redefinida mediante multiple-dispatch para poder reaccionar sin aparente dificultad a cualquier tipo de problema planteado y permitiendo argumentos que personalicen el proceso de solución para cada una de ellas.</p>
<p>Como ejemplo, aquí tenemos que el problema <code class="docutils literal notranslate"><span class="pre">prob_u</span></code> se resuelve mediante un <strong>solver</strong> llamado <code class="docutils literal notranslate"><span class="pre">Tsit5</span></code>. La lista de solvers incluidos en el paquete puede encontrarse en su documentación <a class="reference external" href="https://diffeq.sciml.ai/stable/tutorials/ode_example/##Choosing-a-Solver-Algorithm">aquí</a>, y de éstos se habla en mayor profundidad luego.</p>
<p>Además, se ilustra que podemos elegir un error relativo y error absoluto que queremos aceptar para que el solver lo garantice. Leer más sobre los tipos de errores de aproximación <a class="reference external" href="https://en.wikipedia.org/wiki/Approximation_error">aquí</a>.</p>
<p>Posterior a resolver la ecuación diferencial, podemos explorar su comportamiento de manera gráfica:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">begin</span>
	<span class="n">plot</span><span class="p">(</span><span class="n">sol_u</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Solución aproximada al problema&quot;</span><span class="p">,</span>
     <span class="n">xaxis</span><span class="o">=</span><span class="s">&quot;Time (t)&quot;</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">=</span><span class="s">&quot;u(t) (in μm)&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Aproximación&quot;</span><span class="p">)</span>
	<span class="n">plot!</span><span class="p">(</span><span class="n">sol_u</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">-&gt;</span><span class="mf">0.5</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.01</span><span class="n">t</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">ls</span><span class="o">=:</span><span class="n">dash</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Solución exacta&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="pendulo-caotico">
<h3>Péndulo caótico<a class="headerlink" href="#pendulo-caotico" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El péndulo doble es un sistema muy famosamente estudiado por exhibir un comportamiento <strong>caótico</strong> (cuya definición matemática es rigurosa). Sus ecuaciones del movimiento son las siguientes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{d}{dt}
\begin{pmatrix}
\alpha \\ l_\alpha \\ \beta \\ l_\beta
\end{pmatrix}=
\begin{pmatrix}
2\frac{l_\alpha - (1+\cos\beta)l_\beta}{3-\cos 2\beta} \\
-2\sin\alpha - \sin(\alpha + \beta) \\
2\frac{-(1+\cos\beta)l_\alpha + (3+2\cos\beta)l_\beta}{3-\cos2\beta}\\
-\sin(\alpha+\beta) - 2\sin(\beta)\frac{(l_\alpha-l_\beta)l_\beta}{3-\cos2\beta} + 2\sin(2\beta)\frac{l_\alpha^2-2(1+\cos\beta)l_\alpha l_\beta + (3+2\cos\beta)l_\beta^2}{(3-\cos2\beta)^2}
\end{pmatrix}\end{split}\]</div>
<p>Resolveremos este sistema utilizando los métodos del paquetes <code class="docutils literal notranslate"><span class="pre">DifferentialEquations.jl</span></code>.</p>
<p>El movimiento generado por esta ecuaciones se ve similar a:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">html</span><span class="s">&quot;</span>
<span class="s">&lt;p align=&#39;center&#39;&gt;</span>
<span class="s">&lt;img width=&#39;216&#39; height=&#39;190&#39; src=&#39;https://upload.wikimedia.org/wikipedia/commons/6/65/Trajektorie_eines_Doppelpendels.gif&#39;&gt;</span>
<span class="s">&lt;/p&gt;</span>
<span class="s">&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="c">## El prefijo const es opcional y no significa VALOR constante, si no tipo constante.</span>
<span class="k">begin</span>
	<span class="kd">const</span> <span class="n">m₁</span><span class="p">,</span> <span class="n">m₂</span><span class="p">,</span> <span class="n">L₁</span><span class="p">,</span> <span class="n">L₂</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">9.81</span>   
	<span class="n">initial</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="nb">π</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="nb">pi</span><span class="o">/</span><span class="mi">5</span><span class="p">]</span>
	<span class="n">tspan</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">)</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>Se define una función auxiliar para transformar de coordenadas polares a cartesianas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">polar2cart</span><span class="p">(</span><span class="n">sol</span><span class="p">;</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">l1</span><span class="o">=</span><span class="n">L₁</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="n">L₂</span><span class="p">,</span> <span class="n">vars</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span><span class="n">dt</span><span class="o">:</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="k">end</span><span class="p">]</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">l1</span><span class="o">*</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="p">[</span><span class="n">vars</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">sol</span><span class="o">.</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">l2</span><span class="o">*</span><span class="n">map</span><span class="p">(</span><span class="n">y</span><span class="o">-&gt;</span><span class="n">y</span><span class="p">[</span><span class="n">vars</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">sol</span><span class="o">.</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
    <span class="n">x1</span> <span class="o">=</span> <span class="n">l1</span><span class="o">*</span><span class="n">sin</span><span class="o">.</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">l1</span><span class="o">*-</span><span class="n">cos</span><span class="o">.</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">l2</span><span class="o">*</span><span class="n">sin</span><span class="o">.</span><span class="p">(</span><span class="n">p2</span><span class="p">),</span>
     <span class="n">y1</span> <span class="o">-</span> <span class="n">l2</span><span class="o">*</span><span class="n">cos</span><span class="o">.</span><span class="p">(</span><span class="n">p2</span><span class="p">)))</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">double_pendulum</span><span class="p">(</span><span class="n">xdot</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
    <span class="n">xdot</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">xdot</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="p">((</span><span class="n">g</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m₁</span><span class="o">+</span><span class="n">m₂</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">m₂</span><span class="o">*</span><span class="p">(</span><span class="n">g</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> 
				<span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">L₂</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">L₁</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])))</span><span class="o">/</span>
		        <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">L₁</span><span class="o">*</span><span class="p">(</span><span class="n">m₁</span><span class="o">+</span><span class="n">m₂</span><span class="o">-</span><span class="n">m₂</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">xdot</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">xdot</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">(((</span><span class="n">m₁</span><span class="o">+</span><span class="n">m₂</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">L₁</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">g</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">+</span> 
			   <span class="n">L₂</span><span class="o">*</span><span class="n">m₂</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span><span class="o">/</span>
			   <span class="p">(</span><span class="n">L₂</span><span class="o">*</span><span class="p">(</span><span class="n">m₁</span><span class="o">+</span><span class="n">m₂</span><span class="o">-</span><span class="n">m₂</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">double_pendulum_problem</span> <span class="o">=</span> <span class="n">ODEProblem</span><span class="p">(</span><span class="n">double_pendulum</span><span class="p">,</span> <span class="n">initial</span><span class="p">,</span> <span class="n">tspan</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">double_pendulum_problem</span><span class="p">,</span> <span class="n">Vern7</span><span class="p">(),</span> <span class="n">abs_tol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">begin</span>
	<span class="n">ts</span><span class="p">,</span> <span class="n">ps</span> <span class="o">=</span> <span class="n">polar2cart</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">l1</span><span class="o">=</span><span class="n">L₁</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="n">L₂</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
	<span class="n">plot</span><span class="p">(</span><span class="n">ps</span><span class="o">...</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sistema-de-henon-heiles">
<h3>3. Sistema de Hénon-Heiles<a class="headerlink" href="#sistema-de-henon-heiles" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Es un sistema dinámico que modela el movimiento de una estrella orbitando alrededor de su centro galáctico mientras yace restringido en un plano. Éste es un ejemplo de un sistema Hamiltoniano, y tiene la forma:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\frac{d^2x}{dt^2}&amp;=-\frac{\partial V}{\partial x}\\
\frac{d^2y}{dt^2}&amp;=-\frac{\partial V}{\partial y}
\end{align}
\end{split}\]</div>
<p>donde</p>
<div class="math notranslate nohighlight">
\[V(x,y)={\frac {1}{2}}(x^{2}+y^{2})+\lambda \left(x^{2}y-{\frac {y^{3}}{3}}\right).\]</div>
<p>es conocido como el <strong>potencial de Hénon–Heiles</strong>. De éste puede derivarse su Hamiltoniano:</p>
<div class="math notranslate nohighlight">
\[H={\frac {1}{2}}(p_{x}^{2}+p_{y}^{2})+{\frac {1}{2}}(x^{2}+y^{2})+\lambda \left(x^{2}y-{\frac {y^{3}}{3}}\right).\]</div>
<p>Esta cantidad representa un invariante del sistema dinámico: Una cantidad conservada. En este caso, es la energía total del sistema.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">begin</span>
	<span class="c">## Parámetros</span>
	<span class="n">initial₂</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">tspan₂</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">100.</span><span class="p">)</span>
	<span class="c">## V: Potencial, T: Energía cinética total, E: Energía total</span>
	<span class="n">V</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">//</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">//</span><span class="mi">3</span> <span class="o">*</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
	<span class="n">E</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">)</span> <span class="o">=</span> <span class="n">V</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">//</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">dx</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">^</span><span class="mi">2</span><span class="p">);</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>Definimos el modelo en una función:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">Hénon_Heiles</span><span class="p">(</span><span class="n">du</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
    <span class="n">x</span>  <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">y</span>  <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">du</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">dx</span>
    <span class="n">du</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">dy</span>
    <span class="n">du</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="n">x</span><span class="o">*</span><span class="n">y</span>
    <span class="n">du</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<p>Resolvemos el problema:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">begin</span>
	<span class="n">prob₂</span> <span class="o">=</span> <span class="n">ODEProblem</span><span class="p">(</span><span class="n">Hénon_Heiles</span><span class="p">,</span> <span class="n">initial₂</span><span class="p">,</span> <span class="n">tspan₂</span><span class="p">)</span>
	<span class="n">sol₂</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">prob₂</span><span class="p">,</span> <span class="n">Vern9</span><span class="p">(),</span> <span class="n">abs_tol</span><span class="o">=</span><span class="mf">1e-16</span><span class="p">,</span> <span class="n">rel_tol</span><span class="o">=</span><span class="mf">1e-16</span><span class="p">);</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">sol₂</span><span class="p">,</span> <span class="n">vars</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;Órbita del sistema de Hénon-Heiles&quot;</span><span class="p">,</span> <span class="n">xaxis</span> <span class="o">=</span> <span class="s">&quot;x&quot;</span><span class="p">,</span> <span class="n">yaxis</span> <span class="o">=</span> <span class="s">&quot;y&quot;</span><span class="p">,</span> <span class="n">leg</span><span class="o">=</span><span class="kc">false</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Parece estar correctamente resuelto pero… examinando la evolución de la energía total/Hamiltoniano podemos encontrar lo siguiente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">begin</span>
	<span class="n">energy</span> <span class="o">=</span> <span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">E</span><span class="p">(</span><span class="n">x</span><span class="o">...</span><span class="p">),</span> <span class="n">sol₂</span><span class="o">.</span><span class="n">u</span><span class="p">)</span>
	<span class="n">plot</span><span class="p">(</span><span class="n">sol₂</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">energy</span> <span class="o">.-</span> <span class="n">energy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;Cambio de la energía en el tiempo&quot;</span><span class="p">,</span> <span class="n">xaxis</span> <span class="o">=</span> <span class="s">&quot;Número de iteraciones&quot;</span><span class="p">,</span> <span class="n">yaxis</span> <span class="o">=</span> <span class="s">&quot;Cambio en energía&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
<p>¡La energía total cambia! Eso quiere decir que la ley de conservación que esperamos que se cumpla físicamente no parece cumplirse en nuestra simulación. Esto delata un error en la resolución de la ecuación, específicamente por el método utilizado.</p>
<p>Para evitar eso, podemos utilizar algo conocido como un <strong>integrador simplético</strong> que considere la estructura de sistema Hamiltoniano que tiene nuestras ecuaciones.</p>
<p>Éste lo implementamos a continuación:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">HH_acceleration!</span><span class="p">(</span><span class="n">dv</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span>  <span class="o">=</span> <span class="n">u</span>
    <span class="n">dx</span><span class="p">,</span><span class="n">dy</span> <span class="o">=</span> <span class="n">dv</span>
    <span class="n">dv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="n">x</span><span class="o">*</span><span class="n">y</span>
    <span class="n">dv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>Debemos ahora definir la condición inicial por separado, pues nuestro sistema, al ser Hamiltoniano, tiene una segmentación natural en esos pares de variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">begin</span>
	<span class="n">initial_positions</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]</span>
	<span class="n">initial_velocities</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>Resolvemos el problema ahora como una ecuación de segundo orden pero con estructura simpléctica detectada:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">begin</span>
	<span class="n">prob₃</span> <span class="o">=</span> <span class="n">SecondOrderODEProblem</span><span class="p">(</span><span class="n">HH_acceleration!</span><span class="p">,</span> 
								 <span class="n">initial_velocities</span><span class="p">,</span>
								 <span class="n">initial_positions</span><span class="p">,</span>
								 <span class="n">tspan₂</span><span class="p">)</span>
	<span class="n">sol₃</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">prob₃</span><span class="p">,</span> <span class="n">KahanLi8</span><span class="p">(),</span> <span class="n">dt</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<span class="k">end</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>Ahora podemos observar cómo la energía se mantiene muy cercana a cero, oscilando solamente por errores de precisión numérica pero sin existir una tendencia de crecimiento anómala.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">begin</span>
	<span class="n">energy₂</span> <span class="o">=</span> <span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">E</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">sol₃</span><span class="o">.</span><span class="n">u</span><span class="p">)</span>
	<span class="n">plot</span><span class="p">(</span><span class="n">sol₃</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">energy₂</span> <span class="o">.-</span> <span class="n">energy₂</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;Cambio de la energía en el tiempo&quot;</span><span class="p">,</span> <span class="n">xaxis</span> <span class="o">=</span> <span class="s">&quot;Número de iteraciones&quot;</span><span class="p">,</span> <span class="n">yaxis</span> <span class="o">=</span> <span class="s">&quot;Cambio en energía&quot;</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="ecuaciones-diferenciales-estocasticas">
<h2>Ecuaciones diferenciales Estocásticas<a class="headerlink" href="#ecuaciones-diferenciales-estocasticas" title="Enlazar permanentemente con este título">¶</a></h2>
</div>
<div class="section" id="bibliografia">
<h2>Bibliografía<a class="headerlink" href="#bibliografia" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://sciml.ai/">Documentación de SciML</a></p></li>
<li><p><a class="reference external" href="https://github.com/SciML/SciMLTutorials.jl">Tutoriales de SciML</a></p></li>
<li><p>Hénon, Michel (1983), «Numerical exploration of Hamiltonian Systems», in Iooss, G. (ed.), Chaotic Behaviour of Deterministic Systems, Elsevier Science Ltd, pp. 53–170, ISBN 044486542X</p></li>
<li><p>Aguirre, Jacobo; Vallejo, Juan C.; Sanjuán, Miguel A. F. (2001-11-27). «Wada basins and chaotic invariant sets in the Hénon-Heiles system». Physical Review E. American Physical Society (APS). 64 (6): 066208. doi:10.1103/physreve.64.066208. ISSN 1063-651X.</p></li>
<li><p>Steven Johnson. 18.335J Introduction to Numerical Methods . Spring 2019. Massachusetts Institute of Technology: MIT OpenCourseWare, https://ocw.mit.edu. License: Creative Commons BY-NC-SA.</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.5"
        },
        kernelOptions: {
            kernelName: "julia-1.5",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.5'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="Paquete_Plots.html" title="previous page">Paquete Plots</a>
    <a class='right-next' id="next-link" href="Paquete_DataFrames.html" title="next page">Paquete DataFrames</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Luis Felipe Flores Machado, René David Hernández<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.30270b6e4c972e43c488.js"></script>


    
  </body>
</html>